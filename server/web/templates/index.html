{% extends "base.html" %}

{% block title %}Home - SMAN 2 Cikpus{% endblock %}

{% block content %}

<!-- Hero / Intro -->
<section class="hero mb-4">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-7">
        <h1 class="mb-2">SMAN 2 Cikarang Pusat</h1>
        <p class="lead">Moving for bright future.</p>
        <p class="mt-3">
          <a href="#about" class="btn btn-primary me-2">Tentang kami</a>
          <a href="#programs" class="btn btn-secondary me-2">Prestasi</a>
          <a href="#teachers" class="btn btn-info me-2">Guru</a>
          <a href="#prestasi" class="btn btn-success me-2">Pencapaian</a>
        </p>
      </div>
      <div class="col-md-5 d-none d-md-block text-center">
        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="School" style="max-width:260px;">
      </div>
    </div>
  </div>
</section>

<!-- About -->
<section id="about" class="py-4 mb-4 bg-white">
  <div class="container">
    <div class="row">
      <div class="col-md-8">
        <h3>Tentang SMAN 2 Cikarang Pusat</h3>
        <p class="text-muted">(desc)</p>
      </div>
      <div class="col-md-4">
        <h5>Quick Facts</h5>
        <ul class="small-muted list-unstyled">
          <li>Berdiri sejak : 1998</span></li>
          <li>Total siswa: <span class="count" data-target="1098"></span> siswa</li>
          <li>Accreditation: A</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const counters = document.querySelectorAll(".count");

  const animateCount = (el) => {
    const target = +el.getAttribute("data-target");
    const duration = 1500; // ms
    const stepTime = 20;
    const steps = duration / stepTime;
    const increment = target / steps;
    let count = 0;

    const timer = setInterval(() => {
      count += increment;
      if (count >= target) {
        count = target;
        clearInterval(timer);
      }
      el.textContent = Math.floor(count);
    }, stepTime);
  };

  // Start when visible
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        animateCount(entry.target);
        observer.unobserve(entry.target);
      }
    });
  }, { threshold: 0.6 });

  counters.forEach(el => observer.observe(el));
});
</script>


<!-- Programs / Features -->
<section id="programs" class="py-4 mb-4 bg-light">
  <div class="container">
    <h3 class="mb-3">Program sekolah</h3>

    {% if programs and programs|length > 0 %}
    <div id="programCarousel" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-inner">
        {% for p in programs %}
        <div class="carousel-item {% if loop.first %}active{% endif %}">
          <div class="d-flex justify-content-center">
            <div class="card shadow-sm" style="width: 18rem;">
              <div class="card-body text-center">
                <h5>{{ p.title }}</h5>
                <p class="small text-muted">{{ p.description }}</p>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>

      <!-- Carousel controls -->
      <button class="carousel-control-prev" type="button" data-bs-target="#programCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#programCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
    {% else %}
      <p class="text-center text-muted">Program sekolah gagal dimuat.</p>
    {% endif %}

  </div>
</section>

<!-- Teachers -->
<section id="teachers" class="py-4 mb-4 bg-white">
  <div class="container">
    <h3 class="mb-3">Guru-guru</h3>

    {% if gurus %}
    <div id="teacherCarousel" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-inner">
        {% for guru in gurus %}
        <div class="carousel-item {% if loop.first %}active{% endif %}">
          <div class="d-flex justify-content-center">
            <div class="card shadow-sm text-center" style="width: 18rem;">
              <img src="{{ url_for('static', filename='images/teacher-placeholder.svg') }}" 
                   class="card-img-top" alt="Teacher" style="height:200px; object-fit:cover;">
              <div class="card-body">
                <h5 class="card-title">{{ guru.name }}</h5>
                <p class="card-text">{{ guru.subject }}</p>
                <p class="small text-muted">{{ guru.description }}</p>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>

      <!-- Carousel controls -->
      <button class="carousel-control-prev" type="button" data-bs-target="#teacherCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#teacherCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
    {% else %}
      <p class="text-center text-muted">Guru gagal dimuat.</p>
    {% endif %}
  </div>
</section>

<!-- Prestasi / Achievements -->
<section id="prestasi" class="py-4 mb-4 bg-light">
  <div class="container">
    <h3 class="mb-3">Prestasi</h3>

    {% if prestasi and prestasi|length > 0 %}
    <div id="prestasiCarousel" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-inner">
        {% for p in prestasi %}
        <div class="carousel-item {% if loop.first %}active{% endif %}">
          <div class="d-flex justify-content-center">
            <div class="card shadow-sm text-center" style="width: 18rem;">
              <div class="card-body">
                <i class="{{ p.icon }} fa-3x mb-3" style="color: {{ p.color }}"></i>
                <h5 class="card-title">{{ p.title }}</h5>
                <p class="card-text">{{ p.subtitle }}</p>
                <p class="small text-muted">{{ p.preview }}</p>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>

      <!-- Carousel controls -->
      <button class="carousel-control-prev" type="button" data-bs-target="#prestasiCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#prestasiCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
    {% else %}
      <p class="text-center text-muted">Prestasi gagal dimuat.</p>
    {% endif %}

  </div>
</section>



<!-- Showcase / Latest News -->
<section id="showcase" class="py-4 mb-4 bg-white">
  <div class="container">
    <h3 class="mb-3">Berita</h3>

    <div class="row g-3">
      {% if news and news|length > 0 %}
        {% for a in news %}
        <div class="col-md-6">
          <div class="card shadow-sm">
            <div class="card-body">
              <h5 class="card-title">{{ a.title }}</h5>
              <p class="meta">Published: {{ a.created }}</p>
              <p class="card-text">{{ a.preview }}</p>
              <!-- Read more directs to /read/<slug> -->
              <a href="{{ url_for('site.read', slug=a.slug) }}" class="btn btn-sm btn-primary">Read more</a>
            </div>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <div class="col-12">
          <p class="text-muted text-center">Berita gagal dimuat.</p>
        </div>
      {% endif %}
    </div>
  </div>
</section>


<section id="articles" class="mb-5">
  <div class="container">
    <h3 class="mb-3">Artikel</h3>
    <div class="row g-3">
      {% if articles and articles|length > 0 %}
        {% for a in articles %}
        <div class="col-md-6">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h5 class="card-title">{{ a.title }}</h5>
              <p class="card-text text-muted small mb-2">{{ a.created }}</p>
              <p class="card-text text-muted small mb-2">Oleh {{ a.creator }}</p>
              <p class="card-text">{{ a.preview }}</p>
            </div>
            <div class="card-footer bg-transparent border-0">
              <!-- Read more directs to /read/<uuid> -->
              <a href="{{ url_for('site.read', slug=a.uuid) }}" class="btn btn-sm btn-primary">Read more</a>
            </div>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <div class="col-12">
          <p class="text-muted text-center">Artikel gagal dimuat.</p>
        </div>
      {% endif %}
    </div>
  </div>
</section>


<!-- CTA / Contact -->
<section id="cta" class="py-5 bg-white">
  <div class="container">
    <div class="text-center mb-4">
      <h4>Hubungi Kami</h4>
      <p class="text-muted">Hubungi staff kami untuk memberikan tanggapan anda.</p>
    </div>

    <form id="contactForm" method="POST" action="" class="mx-auto" style="max-width: 600px;">
      <div class="mb-3">
        <label for="name" class="form-label">Nama Lengkap</label>
        <input type="text" id="name" name="name" class="form-control" placeholder="Masukkan nama Anda" required>
      </div>

      <div class="mb-3">
        <label for="email" class="form-label">Alamat Email</label>
        <input type="email" id="email" name="email" class="form-control" placeholder="email@email.com" required>
      </div>

      <div class="mb-3">
        <label for="phone" class="form-label">Nomor Telepon (opsional)</label>
        <input type="tel" id="phone" name="phone" class="form-control" placeholder="+62...">
      </div>

      <div class="mb-3">
        <label for="message" class="form-label">Pesan</label>
        <textarea id="message" name="message" class="form-control" rows="4" placeholder="Tulis pesan Anda di sini..." required></textarea>
      </div>

      <div class="text-center">
        <button type="submit" class="btn btn-primary btn-lg">Kirim Pesan</button>
      </div>
    </form>
  </div>
</section>

<script>
// 🧠 Protect from accidental refresh or close when form is not submitted
document.addEventListener("DOMContentLoaded", () => {
  const form = document.getElementById("contactForm");
  let formDirty = false;

  // Detect user typing or modifying any field
  form.addEventListener("input", () => {
    formDirty = true;
  });

  // Remove protection after successful submit
  form.addEventListener("submit", () => {
    formDirty = false;
  });

  // Warn before closing/reloading
  window.addEventListener("beforeunload", (e) => {
    if (formDirty) {
      e.preventDefault();
    }
  });
});
</script>



{% endblock %}